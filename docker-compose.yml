version: '3.8'
services:
  qdrant:
    image: qdrant/qdrant:latest
    container_name: qdrant_vector_db
    ports:
      - "6333:6333"
      - "6334:6334"
    volumes:
      - qdrant_data:/qdrant/data
    restart: always

  backend:
    build: ./backend
    container_name: fastapi_backend
    ports:
      - "8000:8000"
    volumes:
      - ./backend:/app/backend # Mount for live code changes
      - ./frontend/docs/book:/app/frontend/docs/book # Mount Docusaurus book folder for RAG
    depends_on:
      - qdrant
    environment:
      QDRANT_HOST: qdrant # Qdrant service name within docker-compose network
      QDRANT_PORT: 6333
    restart: always

volumes:
  qdrant_data: